
<!-- saved from url=(0141)blob:https://2fq1r70xcc2gjo042phxfn92wqpfeki9hzv1ygt9alc3i83o0l-h763805538.scf.usercontent.goog/e0db6322-7b2a-4a77-b371-5d18a4d5d9c0#section9 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6ImY2ZTAxMDEwMWQ1NmE1NmIyZDY4Y2U3NDZkNmI5YzJlMmFlYzU5ZGQiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6XC9cL2lkZW50aXR5dG9vbGtpdC5nb29nbGVhcGlzLmNvbVwvZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMDc0MTU3MzcyMTM5NDE2NDQ2NiIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJleHAiOjE3NDg2Mjc1NjMsImlhdCI6MTc0ODYyMzk2MywiYWxnIjoiUlMyNTYifQ.gklVs701SZqGm7ChqoH6E23bnDiWhppfkRWYRbzxZjmIVe37mHr9wSpsU8z_ExHff-6S-44UKqg2RLH8S5tQOs_oznobFrRdVS_eKQVCYETZkkGJHv3QrRNX-uZK1anf2zMoQq-Kusy5fQ6xmwM7af8ZOK9rZVNErKBjHfNGqIxnhUP39TtKsUODDm5mlG30TaMzN11Va9VQq8B2mYa4I-WmH1FgcTPXf49-kJSdsFJCPf48wu6ZMZWbjL12ReNrZEEbo5mn0_gcIZ_CMRRhzX1Efp6LjddI0h8iDeNhVRTt12C9FJvH02fEVdIgq1W9Lq49_tFQ5sEoKV2MdXuylg","297afa848fba-algorithm_spa_viewer-379")</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  let originalGetUserMedia = realOriginalGetUserMedia;

  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          const mediaPromiseId = nextMediaPromiseId++;
          const promise = new Promise((resolve, reject) => {
            pendingMediaResolvers[mediaPromiseId] = (granted) => {
              delete pendingMediaResolvers[mediaPromiseId];
              if (granted) {
                if (originalGetUserMedia) {
                  originalGetUserMedia(constraints).then(resolve).catch(reject);
                } else {
                  reject(new Error("Original getUserMedia not available."));
                }
              } else {
              reject(new DOMException('Permission denied', 'NotAllowedError'));
            }
          };
        });

        window.parent.postMessage({
          type: 'requestMediaPermission',
          constraints: constraints,
          promiseId: mediaPromiseId,
        }, '*');

        return promise;
      },
      writable: false,
      configurable: false
    });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>(function() {
  const originalFetch = window.fetch;
  const googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict',
    'https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/veo-2.0-generate-001:predict',
    'https://generativelanguage.googleapis.com/v1beta/models/veo-2.0-generate-001:predictLongRunning',
  ];

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: 'models/' + modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

})();</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Georgia Fantasy 5 Predictor Algorithm Explorer</title>
    <script src="https://cdn.tailwindcss.com/"></script>
    <!-- Application Structure Plan: 
        Layout: Adaptive single-page application. On large screens (lg+), a fixed left sidebar for navigation and a main content area (styled as a floating card) on the right. On smaller screens, the sidebar collapses into a horizontal top navigation bar, and the main content occupies full width.
        Navigation: Clickable links in the sidebar/top bar correspond to major sections of the "Georgia Fantasy 5 Predictor Algorithm".
        Content Display: Clicking a navigation link dynamically displays the detailed content of that algorithm section in the main area. Sub-sections are presented clearly with distinct headings and structured lists.
        Interactions: Primary interaction is click-based navigation to switch content views. Active navigation links are visually highlighted.
        Rationale: This structure provides clear content segmentation and intuitive navigation. The responsive adaptation ensures usability on diverse devices, while the card-like main content area improves focus and visual appeal.
    -->
    <!-- Visualization & Content Choices: 
        Report Info: "Georgia Fantasy 5 Predictor Algorithm" document.
        Goal: Make algorithm steps explorable and understandable, enhancing clarity and engagement.
        Viz/Presentation Method: Content is primarily textual, presented using semantic HTML elements (headings, paragraphs, ordered/unordered lists) styled with Tailwind CSS for hierarchy and readability. Key terms are highlighted for emphasis.
        Interaction: Vanilla JavaScript handles the dynamic display of content sections based on navigation clicks. This avoids full page reloads, providing a smooth SPA experience.
        Justification: For an algorithm document, direct textual representation with clear hierarchy and functional navigation is the most effective and accessible method. Complex data visualizations are not applicable here, as the content is procedural and descriptive.
        Library/Method: HTML, Tailwind CSS, Vanilla JavaScript. NO Chart.js/Plotly.js.
    -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        /* Sidebar Link Styling */
        .sidebar-link {
            cursor: pointer;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem; /* Slightly more rounded */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            font-weight: 500; /* Medium weight */
            color: #475569; /* slate-600 */
        }
        .sidebar-link:hover {
            background-color: #e0f2fe; /* blue-50 */
            color: #1d4ed8; /* blue-700 */
        }
        .sidebar-link.active {
            background-color: #2563eb; /* blue-600 */
            color: white;
            font-weight: 600; /* Semibold */
        }
        /* Heading Styles */
        h2, h3, h4 {
            font-weight: 600;
            margin-top: 2rem; /* Increased margin-top */
            margin-bottom: 1rem; /* Increased margin-bottom */
            line-height: 1.3;
        }
        h2 {
            font-size: 2.25rem; /* text-4xl */
            color: #1e3a8a; /* blue-800 */
            border-bottom: 2px solid #cbd5e1; /* slate-300 */
            padding-bottom: 0.75rem;
        }
        h3 {
            font-size: 1.875rem; /* text-3xl */
            color: #1d4ed8; /* blue-700 */
        }
        h4 {
            font-size: 1.5rem; /* text-2xl */
            color: #2563eb; /* blue-600 */
        }
        /* List and Paragraph Styles */
        ul, ol {
            list-style-position: outside; /* Ensure bullets/numbers are outside text */
            margin-left: 1.5rem; /* Increased indent */
            margin-bottom: 1.25rem;
        }
        li {
            margin-bottom: 0.625rem; /* Slightly more space between list items */
            line-height: 1.6;
            color: #374151; /* gray-700 */
        }
        p {
            margin-bottom: 1.25rem;
            line-height: 1.7; /* Increased line height for readability */
            color: #374151; /* gray-700 */
        }
        .section-intro {
            background-color: #eef2ff; /* indigo-50 */
            padding: 1.5rem; /* Increased padding */
            border-radius: 0.75rem; /* More rounded corners */
            margin-bottom: 2rem; /* Increased margin-bottom */
            border-left: 5px solid #4f46e5; /* indigo-600 */
            color: #374151; /* gray-700 */
        }
        .step-item > strong {
             color: #4338ca; /* indigo-700 */
        }
        /* Code-like blocks */
        .code-like {
            background-color: #f8fafc; /* slate-50 */
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', monospace; /* More modern monospace font stack */
            white-space: pre-wrap;
            word-break: break-all;
            border: 1px solid #e2e8f0; /* slate-200 */
            margin-top: 1rem;
            margin-bottom: 1rem;
            color: #1a202c; /* gray-900 */
        }

        /* Responsive adjustments for sidebar/topbar */
        @media (max-width: 1023px) { /* lg breakpoint */
            aside {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: auto;
                max-height: 100px; /* Limit height of top bar */
                overflow-x: auto; /* Allow horizontal scroll for nav items */
                overflow-y: hidden;
                border-bottom: 1px solid #cbd5e1; /* slate-300 */
                border-right: none;
                padding: 0.75rem 1rem;
                display: flex;
                flex-direction: row;
                align-items: center;
                z-index: 1000; /* Ensure it stays on top */
                box-shadow: 0 2px 4px rgba(0,0,0,0.05); /* Subtle shadow */
            }
            aside h1 {
                display: none; /* Hide title on small screens */
            }
            aside nav {
                display: flex;
                flex-direction: row;
                flex-wrap: nowrap; /* Prevent wrapping */
                gap: 0.75rem; /* Space between nav items */
                padding-left: 0;
                padding-right: 0;
                width: 100%;
                justify-content: flex-start; /* Align items to start */
            }
            aside .sidebar-link {
                flex-shrink: 0; /* Prevent shrinking */
                padding: 0.5rem 0.8rem;
                font-size: 0.875rem; /* text-sm */
            }
            main {
                margin-left: 0;
                margin-top: 100px; /* Space for fixed top bar */
                width: 100%;
                padding: 1.5rem;
            }
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.16 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.left-0{left:0px}.top-0{top:0px}.m-4{margin:1rem}.mb-6{margin-bottom:1.5rem}.ml-10{margin-left:2.5rem}.ml-12{margin-left:3rem}.ml-14{margin-left:3.5rem}.ml-6{margin-left:1.5rem}.ml-8{margin-left:2rem}.flex{display:flex}.hidden{display:none}.h-auto{height:auto}.min-h-screen{min-height:100vh}.w-full{width:100%}.list-decimal{list-style-type:decimal}.list-disc{list-style-type:disc}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.overflow-y-auto{overflow-y:auto}.rounded-lg{border-radius:0.5rem}.border-b{border-bottom-width:1px}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.bg-slate-50{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.p-4{padding:1rem}.pt-6{padding-top:1.5rem}.text-2xl{font-size:1.5rem;line-height:2rem}.font-bold{font-weight:700}.text-slate-800{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.text-slate-900{--tw-text-opacity:1;color:rgb(15 23 42 / var(--tw-text-opacity, 1))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}@media (min-width: 1024px){.lg\:relative{position:relative}.lg\:m-8{margin:2rem}.lg\:ml-\[25\%\]{margin-left:25%}.lg\:block{display:block}.lg\:h-full{height:100%}.lg\:w-1\/4{width:25%}.lg\:w-3\/4{width:75%}.lg\:flex-row{flex-direction:row}.lg\:flex-col{flex-direction:column}.lg\:items-start{align-items:flex-start}.lg\:justify-start{justify-content:flex-start}.lg\:space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.lg\:overflow-y-auto{overflow-y:auto}.lg\:border-b-0{border-bottom-width:0px}.lg\:border-r{border-right-width:1px}.lg\:p-6{padding:1.5rem}.lg\:p-8{padding:2rem}.lg\:pt-6{padding-top:1.5rem}}</style></head>
<body class="bg-slate-50 text-slate-800 flex flex-col lg:flex-row min-h-screen">

    <aside class="w-full lg:w-1/4 bg-slate-100 p-4 lg:p-6 border-b lg:border-b-0 lg:border-r border-slate-200 fixed lg:relative top-0 left-0 h-auto lg:h-full overflow-y-auto lg:overflow-y-auto">
        <h1 class="text-2xl font-bold text-slate-900 mb-6 hidden lg:block">Algorithm Explorer</h1>
        <nav id="sidebarNav" class="space-y-2 lg:space-y-2 flex flex-row lg:flex-col items-center lg:items-start justify-center lg:justify-start">
            <a class="sidebar-link" data-target="intro">Overview</a>
            <a class="sidebar-link" data-target="section1">1. Initialization &amp; Setup</a>
            <a class="sidebar-link" data-target="section2">2. Data Loading</a>
            <a class="sidebar-link" data-target="section3">3. Statistical Calculations</a>
            <a class="sidebar-link" data-target="section4">4. Filtering Algorithm</a>
            <a class="sidebar-link" data-target="section5">5. Scoring Algorithm</a>
            <a class="sidebar-link" data-target="section6">6. Prediction Generation</a>
            <a class="sidebar-link" data-target="section7">7. Column 1 Selection</a>
            <a class="sidebar-link" data-target="section8">8. Export Algorithm</a>
            <a class="sidebar-link active" data-target="section9">9. API Statistics</a>
        </nav>
    </aside>

    <main class="w-full lg:w-3/4 lg:ml-[25%] p-4 lg:p-8 pt-6 lg:pt-6 overflow-y-auto bg-white rounded-lg shadow-lg m-4 lg:m-8">
        <section id="intro" class="content-section">
            <h2>Georgia Fantasy 5 Predictor Algorithm Overview</h2>
            <div class="section-intro">
                <p>This interactive explorer provides a detailed breakdown of the "Georgia Fantasy 5 Predictor Algorithm". The application's primary goal is to generate and filter lottery number combinations based on historical data and predefined statistical criteria, then present these as predictions. Navigate through the sections using the sidebar to understand each component of the algorithm.</p>
            </div>
            <p>The algorithm is designed for a Flask web application that connects to a MySQL database to leverage historical lottery data. It involves several key stages: initializing the application and predictor, loading various data sources (rank limits, rank counts, column 1 distributions, historical draws), performing statistical calculations on number combinations, filtering these combinations based on a set of rules, scoring the filtered combinations, and finally generating predictions. It also includes functionalities for exporting predictions and providing statistical insights via API endpoints.</p>
        </section>

        <section id="section1" class="content-section">
            <h2>1. Application Initialization and Setup</h2>
            <div class="section-intro">
                <p>This section details the initial steps required to set up the Flask application and the core predictor engine. It covers database configuration and the loading of essential parameters and data that form the foundation for the prediction logic.</p>
            </div>
            <ol class="list-decimal">
                <li class="step-item"><strong>Start Flask Application:</strong>
                    <ul class="list-disc ml-6">
                        <li>Initialize the Flask web server.</li>
                        <li>Configure MySQL database connection parameters (host, user, password, database).</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Initialize Predictor Instance (Singleton Pattern):</strong>
                    <ul class="list-disc ml-6">
                        <li>Upon the first request (or application startup if pre-initialized), create a single instance of `GeorgiaFantasy5Predictor`.</li>
                        <li><strong>Inside `GeorgiaFantasy5Predictor.__init__`:</strong>
                            <ul class="list-circle ml-6">
                                <li>Establish a connection to the MySQL database.</li>
                                <li>Define lottery specifics (numbers 1-39, 5 numbers per draw).</li>
                                <li>Set initial filter parameters (e.g., `max_seq2`, `max_seq3`, `max_mod_tot`, `sum_range`).</li>
                                <li><strong>Load Rank Limits:</strong> Call `load_rank_limits()` to fetch rank limits from `ga_f5_rank_limits` table. If database connection fails or no data, use hardcoded defaults.</li>
                                <li><strong>Load Rank Counts:</strong> Call `load_rank_counts()` to fetch rank counts from `ga_f5_rank_counts` table. If database connection fails or no data, use hardcoded defaults.</li>
                                <li><strong>Load Column 1 Data:</strong> Call `load_col1_data()` to load historical first-ball distributions from `draws_col1.csv`.
                                    <ul class="list-disc ml-8">
                                        <li>This function parses the CSV, creating a dictionary `col1_data` where keys are `(sum_range, even_count_str, odd_count_str)` and values are lists of historically occurring first ball numbers.</li>
                                        <li>It generates keys for exact sums, sum ranges (e.g., "&lt;85", "85-95"), specific even/odd counts, and wildcard combinations (e.g., `("85-95", "*", "*")`, `("*", "2", "3")`, `("*", "*", "*")`).</li>
                                    </ul>
                                </li>
                                <li><strong>Create Column 1 Cyclers:</strong> For each non-empty list of values in `col1_data`, create an `itertools.cycle` object to enable round-robin selection of `col1` values.</li>
                                <li><strong>Load Historical Draws:</strong> Call `load_historical_data()` to fetch all past lottery draws from `ga_f5_draws` table into a Pandas DataFrame. If database connection fails, initialize an empty DataFrame.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ol>
        </section>

        <section id="section2" class="content-section">
            <h2>2. Data Loading Algorithms (Detailed)</h2>
            <div class="section-intro">
                <p>This section describes the algorithms used for loading various data sources essential for the prediction process. This includes rank-related data from the database and historical first-ball distributions from a CSV file.</p>
            </div>
            
            <h4>2.1. `load_rank_limits()` and `load_rank_counts()`</h4>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> Optional `conn` (database connection) and `cursor`.</li>
                <li class="step-item"><strong>Database Query:</strong>
                    <ul class="list-disc ml-6">
                        <li>If `conn` and `cursor` are provided, execute `SELECT rank_limit/rank_count FROM ga_f5_rank_limits/ga_f5_rank_counts ORDER BY rank_id`.</li>
                        <li>If not provided, attempt to establish a new temporary database connection and cursor, then execute the query.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Process Results:</strong>
                    <ul class="list-disc ml-6">
                        <li>Fetch all results.</li>
                        <li>Extract integer values from the fetched rows (handling both dictionary and tuple results).</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Handle No Data/Error:</strong>
                    <ul class="list-disc ml-6">
                        <li>If no results are found or a database error occurs, print a message and return a predefined list of default rank limits/counts.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Cleanup (for temporary connection):</strong> If a temporary connection was opened, close the cursor and connection.</li>
                <li class="step-item"><strong>Output:</strong> List of integer rank limits/counts.</li>
            </ol>

            <h4>2.2. `load_col1_data(file_path)`</h4>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> `file_path` (e.g., 'draws_col1.csv').</li>
                <li class="step-item"><strong>Initialize:</strong> Create an empty dictionary `col1_data`.</li>
                <li class="step-item"><strong>Read CSV:</strong> Open and read the CSV file using `csv.reader`.
                    <ul class="list-disc ml-6">
                        <li>Skip the header row.</li>
                        <li>For each data row:
                            <ul class="list-circle ml-6">
                                <li>Parse `sum_val`, `even_val`, `odd_val`, `col1_val`.</li>
                                <li>Skip if any value is empty or cannot be converted to integer.</li>
                                <li><strong>Create Exact Sum Key:</strong> Form a key `(f"{sum_int}-{sum_int}", even_val, odd_val)` and add `col1_val` to its list in `col1_data`.</li>
                                <li><strong>Create Range-Based Key:</strong> Determine the `sum_range` (e.g., "&lt;85", "85-95") for `sum_int`. Form a key `(sum_range, even_val, odd_val)` and add `col1_val` to its list in `col1_data`.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="step-item"><strong>Create Wildcard Entries:</strong>
                    <ul class="list-disc ml-6">
                        <li>For each `sum_range` (e.g., "&lt;85", "85-95", etc.):
                            <ul class="list-circle ml-6">
                                <li>Create a wildcard key `(sum_range, "*", "*")`.</li>
                                <li>Aggregate all `col1_val`s associated with that `sum_range` (regardless of even/odd) into this wildcard key's list.</li>
                            </ul>
                        </li>
                        <li>For each combination of `even` and `odd` counts:
                            <ul class="list-circle ml-6">
                                <li>Create a wildcard key `("*", even, odd)`.</li>
                                <li>Aggregate all `col1_val`s associated with that `even`/`odd` combination (regardless of sum) into this wildcard key's list.</li>
                            </ul>
                        </li>
                        <li>Create a global wildcard key `("*", "*", "*")` and populate it with a default range of numbers (1-15).</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Output:</strong> Dictionary `col1_data` mapping various sum/even/odd combinations (including wildcards) to lists of possible first ball values.</li>
            </ol>
        </section>

        <section id="section3" class="content-section">
            <h2>3. Statistical Calculation Algorithms</h2>
            <div class="section-intro">
                <p>This section details the algorithms used to calculate various statistical properties of lottery number combinations. These statistics are crucial for filtering and scoring potential predictions.</p>
            </div>

            <h4>3.1. `count_sequential_numbers(numbers)`</h4>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> A list of 5 numbers.</li>
                <li class="step-item"><strong>Sort:</strong> Sort the numbers in ascending order.</li>
                <li class="step-item"><strong>Count Sequences of 2 (`seq2`):</strong> Iterate through the sorted numbers, checking if `numbers[i+1] - numbers[i] == 1`. Increment `seq2` for each pair.</li>
                <li class="step-item"><strong>Count Sequences of 3 (`seq3`):</strong> Iterate through the sorted numbers, checking if `numbers[i+1] - numbers[i] == 1` AND `numbers[i+2] - numbers[i+1] == 1`. Increment `seq3` for each triplet.</li>
                <li class="step-item"><strong>Output:</strong> `(seq2, seq3)`</li>
            </ol>

            <h4>3.2. `calculate_modular_total(numbers)`</h4>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> A list of 5 numbers.</li>
                <li class="step-item"><strong>Initialize:</strong> `mod_counts` (list of 10 zeros), `mod_total = 0`, `mod_x = 0`.</li>
                <li class="step-item"><strong>Count Modulo Frequencies:</strong> For each `num` in `numbers`, increment `mod_counts[num % 10]`.</li>
                <li class="step-item"><strong>Calculate `mod_total`:</strong> Sum `max(0, count - 1)` for each `count` in `mod_counts`. (This counts how many numbers share the same last digit beyond the first occurrence).</li>
                <li class="step-item"><strong>Calculate `mod_x`:</strong> Count how many `mod_counts` have a `count &gt; 2`.</li>
                <li class="step-item"><strong>Output:</strong> `(mod_total, mod_x)`</li>
            </ol>

            <h4>3.3. `calculate_decade_distribution(numbers)`</h4>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> A list of 5 numbers.</li>
                <li class="step-item"><strong>Initialize:</strong> `d0, d1, d2, d3 = 0, 0, 0, 0` (for decades 1-9, 10-19, 20-29, 30-39).</li>
                <li class="step-item"><strong>Count Decades:</strong> For each `num` in `numbers`, increment the corresponding decade counter based on its range.</li>
                <li class="step-item"><strong>Output:</strong> `(d0, d1, d2, d3)`</li>
            </ol>

            <h4>3.4. `calculate_duplicates_from_previous(numbers, max_draws=10)`</h4>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> A list of 5 numbers (`numbers`), `max_draws` (number of previous draws to check).</li>
                <li class="step-item"><strong>Get Last Draws:</strong> Retrieve the last `max_draws` from `self.historical_draws`.</li>
                <li class="step-item"><strong>Calculate Individual Duplicates (`dup_counts`):</strong>
                    <ul class="list-disc ml-6">
                        <li>For each of the last `max_draws`:
                            <ul class="list-circle ml-6">
                                <li>Extract the 5 numbers from that historical draw.</li>
                                <li>Count the intersection of `numbers` and the historical draw's numbers.</li>
                                <li>Append the count to `dup_counts`.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="step-item"><strong>Calculate Cumulative Duplicates (`cumulative_dups`):</strong>
                    <ul class="list-disc ml-6">
                        <li>For `i` from 1 to `max_draws`:
                            <ul class="list-circle ml-6">
                                <li>Collect all unique numbers from the last `i` historical draws.</li>
                                <li>Count the intersection of `numbers` and these cumulative unique numbers.</li>
                                <li>Append the count to `cumulative_dups`.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="step-item"><strong>Output:</strong> `(dup_counts, cumulative_dups)`</li>
            </ol>

            <h4>3.5. `_calculate_stats(numbers)`</h4>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> A list of 5 numbers.</li>
                <li class="step-item"><strong>Calculate Basic Stats:</strong> Mean, median using `numpy`.</li>
                <li class="step-item"><strong>Calculate Derived Stats:</strong>
                    <ul class="list-disc ml-6">
                        <li>Even/Odd counts.</li>
                        <li>Decade distribution (calling `calculate_decade_distribution`).</li>
                        <li>Sequential counts (calling `count_sequential_numbers`).</li>
                        <li>Modular analysis (calling `calculate_modular_total`).</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Rank Analysis:</strong> If `rank_limits` and `rank_counts` are available, store them in the stats dictionary for each number's position.</li>
                <li class="step-item"><strong>Output:</strong> A dictionary containing all calculated statistical measures.</li>
            </ol>
        </section>

        <section id="section4" class="content-section">
            <h2>4. Filtering Algorithm (`filter_combination`)</h2>
            <div class="section-intro">
                <p>This algorithm applies a series of predefined rules to determine if a generated 5-number combination is valid and meets the desired statistical profile. Combinations that pass all filters are considered for scoring and prediction.</p>
            </div>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> A 5-number `combination`.</li>
                <li class="step-item"><strong>Basic Validation:</strong> Return `False` if `len(combination)` is not 5.</li>
                <li class="step-item"><strong>Even/Odd Check:</strong>
                    <ul class="list-disc ml-6">
                        <li>Calculate `even_count` and `odd_count`.</li>
                        <li>Return `False` if `even_count` is not between 2 and 3 (inclusive) or `odd_count` is not between 2 and 3 (inclusive).</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Sequential Numbers Check:</strong>
                    <ul class="list-disc ml-6">
                        <li>Call `count_sequential_numbers()`.</li>
                        <li>Return `False` if `seq2 &gt; self.max_seq2` or `seq3 &gt; self.max_seq3`.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Modular Total Check:</strong>
                    <ul class="list-disc ml-6">
                        <li>Call `calculate_modular_total()`.</li>
                        <li>Return `False` if `mod_total &gt; self.max_mod_tot` or `mod_x &gt; 0`.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Decade Distribution Check:</strong>
                    <ul class="list-disc ml-6">
                        <li>Call `calculate_decade_distribution()`.</li>
                        <li>Return `False` if any decade count (`d0, d1, d2, d3`) is greater than 2.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Duplicate from Previous Draws Check:</strong>
                    <ul class="list-disc ml-6">
                        <li>Call `calculate_duplicates_from_previous()`.</li>
                        <li>Return `False` if `dup_counts[0] &gt; 1` (more than 1 duplicate from most recent draw).</li>
                        <li>Return `False` if `cumulative_dups[1] &gt; 2` (more than 2 duplicates from cumulative last 2 draws).</li>
                        <li>Return `False` if `cumulative_dups[2] &gt; 3` (more than 3 duplicates from cumulative last 3 draws).</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Sum Range Check:</strong>
                    <ul class="list-disc ml-6">
                        <li>Calculate the `total_sum` of the combination.</li>
                        <li>Return `False` if `total_sum` is not within `self.sum_range`.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Pass:</strong> If all checks pass, return `True`.</li>
            </ol>
        </section>

        <section id="section5" class="content-section">
            <h2>5. Scoring Algorithm (`_calculate_score`)</h2>
            <div class="section-intro">
                <p>This algorithm calculates a composite score for a given combination based on various statistical factors and historical data. The score (0-100) helps rank the desirability of a combination.</p>
            </div>
            <ol class="list-decimal">
                 <li class="step-item"><strong>Input:</strong> A `combination` and its pre-calculated `stats`.</li>
                 <li class="step-item"><strong>Frequency Score:</strong>
                    <ul class="list-disc ml-6">
                        <li>Query the database to get the frequency of each number in the `combination` over the last 30 days.</li>
                        <li>Calculate a score based on how often these numbers have appeared, normalizing to 0-100.</li>
                    </ul>
                </li>
                 <li class="step-item"><strong>Even/Odd Balance Score:</strong>
                    <ul class="list-disc ml-6">
                        <li>Calculate a score (0-100) based on how close the even/odd count is to a balanced distribution (e.g., 2-3 or 3-2).</li>
                    </ul>
                </li>
                 <li class="step-item"><strong>Decade Distribution Score:</strong>
                    <ul class="list-disc ml-6">
                        <li>Start with 100. Penalize (subtract points) if decade counts are too high or zero.</li>
                    </ul>
                </li>
                 <li class="step-item"><strong>Sequential Number Penalty:</strong>
                    <ul class="list-disc ml-6">
                        <li>Calculate `seq_penalty` based on `seq2` and `seq3` counts from `stats`. Convert to a `seq_score` (100 - penalty).</li>
                    </ul>
                </li>
                 <li class="step-item"><strong>Sum Score:</strong>
                    <ul class="list-disc ml-6">
                        <li>Query the database for the average sum of draws over the last year.</li>
                        <li>Calculate a score (0-100) based on how close the combination's sum is to this average sum.</li>
                    </ul>
                </li>
                 <li class="step-item"><strong>Rank Score:</strong>
                    <ul class="list-disc ml-6">
                        <li>Iterate through the `combination` numbers by position.</li>
                        <li>For each number, compare its position's `rank_count` to its `rank_limit`.</li>
                        <li>Award points if the constraint is satisfied.</li>
                        <li>Normalize the total awarded points to a 0-100 score.</li>
                    </ul>
                </li>
                 <li class="step-item"><strong>Column 1 Bonus:</strong>
                    <ul class="list-disc ml-6">
                        <li>Check if the first number of the `combination` exists in `self.col1_data` for the combination's sum range and even/odd distribution (or wildcards).</li>
                        <li>Award bonus points based on the specificity of the match.</li>
                    </ul>
                </li>
                 <li class="step-item"><strong>Final Composite Score:</strong>
                    <ul class="list-disc ml-6">
                        <li>Apply predefined weights to each individual score component (frequency, even/odd, decade, sequential, sum, rank, col1).</li>
                        <li>Sum the weighted scores to get the `final_score`.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Output:</strong> A float representing the composite score (0-100).</li>
            </ol>
        </section>

        <section id="section6" class="content-section">
            <h2>6. Prediction Generation Algorithm (`generate_predictions`)</h2>
            <div class="section-intro">
                <p>This is the core algorithm for generating lottery predictions. It attempts to create a specified number of valid and high-scoring combinations by iterating through possibilities and applying filters and scoring.</p>
            </div>
            <ol class="list-decimal">
                 <li class="step-item"><strong>Input:</strong> `count` (number of predictions), `specific_even_odd` (optional tuple for desired even/odd distribution).</li>
                 <li class="step-item"><strong>Handle No Historical Data:</strong> If `self.historical_draws` is empty, generate and return random, filtered combinations with random scores.</li>
                 <li class="step-item"><strong>Get Latest Draw Date:</strong> For tracking.</li>
                 <li class="step-item"><strong>Determine Even/Odd Distributions:</strong> Use `specific_even_odd` if provided, otherwise default to `(2, 3)` and `(3, 2)`.</li>
                 <li class="step-item"><strong>Get Position 3 Candidates:</strong> Query database for frequently occurring numbers in position 3 from recent draws (last 30 days). Fill with other numbers if not enough.</li>
                 <li class="step-item"><strong>Initialize:</strong> `filtered_combinations` (list to store valid combos), `col1_combinations` (dictionary to group valid combos by their `col1` value).</li>
                 <li class="step-item"><strong>Iterative Combination Generation:</strong>
                    <ul class="list-disc ml-6">
                        <li>Loop through predefined `sum_ranges`.</li>
                        <li>For each `sum_range`, determine a `target_sum` (e.g., midpoint).</li>
                        <li>Loop through `even_odd_distributions`:
                            <ul class="list-circle ml-6">
                                <li><strong>Get Column 1 Candidates:</strong> Call `get_col1_candidates()` for the `target_sum`, `even_count`, and `odd_count`.</li>
                                <li>For each `forced_col1` in the `col1_candidates`:
                                    <ul class="list-disc ml-8">
                                        <li>(Optimization): Skip if enough combinations already generated for this `forced_col1`.</li>
                                        <li>Generate `pos5_candidates` (e.g., 20-39), shuffle them.</li>
                                        <li>For several `pos5` candidates:
                                            <ul class="list-circle ml-10">
                                                <li>Skip if `pos5` is too small relative to `forced_col1`.</li>
                                                <li>For several `pos3` candidates (shuffled):
                                                    <ul class="list-disc ml-12">
                                                        <li>Skip if `pos3` is not between `forced_col1` and `pos5`.</li>
                                                        <li>Iterate through all possible `pos2` (between `forced_col1` and `pos3`) and `pos4` (between `pos3` and `pos5`).</li>
                                                        <li><strong>Form Combination:</strong> Create `combo = sorted([forced_col1, pos2, pos3, pos4, pos5])`.</li>
                                                        <li><strong>Attempt Limit:</strong> Increment `attempts` counter; break if `max_attempts` exceeded.</li>
                                                        <li><strong>Filter:</strong> Call `filter_combination(combo)`.</li>
                                                        <li><strong>If Filtered:</strong>
                                                            <ul class="list-circle ml-14">
                                                                <li>Calculate `stats` using `_calculate_stats()`.</li>
                                                                <li>Calculate `score` using `_calculate_score()`.</li>
                                                                <li>Add the combination, score, sum, and stats to `filtered_combinations` and `col1_combinations[forced_col1]`.</li>
                                                                <li>(Optimization): Break inner loops if enough combinations for `forced_col1` are found.</li>
                                                            </ul>
                                                        </li>
                                                    </ul>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                 <li class="step-item"><strong>Handle No Filtered Combinations:</strong> If `filtered_combinations` is empty after all attempts, generate and return random, filtered combinations as a fallback.</li>
                 <li class="step-item"><strong>Ensure Diversity (Post-Generation Refinement):</strong>
                    <ul class="list-disc ml-6">
                        <li>If the number of unique `col1` values in `filtered_combinations` is less than desired, try to generate more combinations specifically for missing `col1` values by randomly generating `pos2, pos3, pos4, pos5` around the `forced_col1`.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Final Selection and Sorting:</strong>
                    <ul class="list-disc ml-6">
                        <li>Select the best combination for each unique `col1` value (based on score).</li>
                        <li>If `count` predictions are not yet met, add more high-scoring combinations, prioritizing diversity in `col5` values, then any remaining high scorers.</li>
                        <li>Sort the final list of predictions by score in descending order.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Output:</strong> A list of dictionaries, each containing a `combination`, `score`, `sum`, and `stats`.</li>
            </ol>
        </section>

        <section id="section7" class="content-section">
            <h2>7. Column 1 Selection Algorithm (`get_next_col1`)</h2>
            <div class="section-intro">
                <p>This function uses a round-robin approach (via `itertools.cycle`) to provide diversity in the first number (col1) of generated predictions, drawing from historically observed first-ball data.</p>
            </div>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> `total_sum`, `even_count`, `odd_count`.</li>
                <li class="step-item"><strong>Define Priority Keys:</strong> Create a list of `possible_keys` for `col1_data` lookup in order of preference:
                    <ul class="list-disc ml-6">
                        <li>Exact sum, exact even/odd: `(f"{total_sum}-{total_sum}", str(even_count), str(odd_count))`</li>
                        <li>Sum range, exact even/odd: `(sum_range, str(even_count), str(odd_count))`</li>
                        <li>Sum range, any even/odd: `(sum_range, "*", "*")`</li>
                        <li>Any sum, exact even/odd: `("*", str(even_count), str(odd_count))`</li>
                        <li>Complete wildcard: `("*", "*", "*")`</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Gather All Candidates:</strong> Collect all possible `col1` values from `self.col1_data` that match any of the `possible_keys`. Store exact match candidates separately.</li>
                <li class="step-item"><strong>Handle No Candidates:</strong> If no candidates found, default to `range(1, 15)`.</li>
                <li class="step-item"><strong>Cycler-Based Selection:</strong>
                    <ul class="list-disc ml-6">
                        <li><strong>Prioritize Exact Match Cycler:</strong> If a cycler (`self.col1_cyclers`) exists for the exact sum key and there are exact match candidates, return `next(self.col1_cyclers[exact_key])`.</li>
                        <li><strong>Generic Cycler:</strong> If no exact match cycler is used or available:
                            <ul class="list-circle ml-6">
                                <li>Use a generic key (e.g., "combined_cycler").</li>
                                <li>If the generic cycler doesn't exist or has been exhausted, shuffle `all_candidates` and create a new `cycle` object, storing it in `self.col1_cyclers`.</li>
                                <li>Return `next(self.col1_cyclers[generic_key])`.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="step-item"><strong>Ultimate Fallback:</strong> If all else fails, return a random integer between 1 and 15.</li>
            </ol>
        </section>

        <section id="section8" class="content-section">
            <h2>8. Export Algorithm (`export_predictions_to_csv`)</h2>
            <div class="section-intro">
                <p>This algorithm handles the export of generated predictions to a CSV file, making them available for download by the user.</p>
            </div>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> `predictions` (list of prediction dictionaries), `filename`.</li>
                <li class="step-item"><strong>Create Temporary File:</strong> Use `tempfile.gettempdir()` to create a temporary CSV file path for security and cleanup.</li>
                <li class="step-item"><strong>Write CSV:</strong>
                    <ul class="list-disc ml-6">
                        <li>Open the file in write mode.</li>
                        <li>Define CSV `fieldnames` (Combination, Score, Sum, Even, Odd, Mean, etc.).</li>
                        <li>Create a `csv.DictWriter`.</li>
                        <li>Write the header row.</li>
                        <li>For each `pred` in `predictions`:
                            <ul class="list-circle ml-6">
                                <li>Format the combination as a string (e.g., "1-5-10-20-35").</li>
                                <li>Extract relevant data from `pred` and its `stats` dictionary into a row dictionary.</li>
                                <li>Write the row to the CSV file.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="step-item"><strong>Output:</strong> Path to the created CSV file.</li>
            </ol>
        </section>

        <section id="section9" class="content-section active">
            <h2>9. API Statistics Algorithms (`/api/stats/...`)</h2>
            <div class="section-intro">
                <p>These algorithms define how statistical data is retrieved and provided via API endpoints (e.g., for number frequency, sum distribution). They typically involve querying the database and formatting the results as JSON.</p>
            </div>
            <p>The API endpoints generally follow this pattern:</p>
            <ol class="list-decimal">
                <li class="step-item"><strong>Input:</strong> Optional `days` parameter from the HTTP query string (defaults usually to 30 or 365).</li>
                <li class="step-item"><strong>Initialize Predictor:</strong> Create a new `GeorgiaFantasy5Predictor` instance (or reuse the global one, depending on Flask context management, though the algorithm suggests new instances for these specific API routes for fresh DB access).</li>
                <li class="step-item"><strong>Database Query:</strong>
                    <ul class="list-disc ml-6">
                        <li>Construct and execute a specific SQL query tailored to the requested statistic (e.g., count frequencies of each ball, group sums into ranges, count even/odd distributions, count decade distributions).</li>
                        <li>The query typically filters data based on the `days` parameter (e.g., `WHERE date &gt;= DATE_SUB(NOW(), INTERVAL {days} DAY)`).</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Process Results:</strong>
                    <ul class="list-disc ml-6">
                        <li>Fetch all results from the database cursor.</li>
                        <li>Format the results into a list of dictionaries suitable for JSON serialization.</li>
                        <li>Handle any `decimal.Decimal` types by converting them to floats or integers.</li>
                        <li>For frequency stats, fill in missing ball numbers with a frequency of 0 to ensure all balls from 1-39 are represented.</li>
                    </ul>
                </li>
                <li class="step-item"><strong>Output:</strong> JSON response containing the statistical data (e.g., `{'data': [...]}`). If an error occurs, a JSON error message with an appropriate HTTP status code is returned.</li>
            </ol>
        </section>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navLinks = document.querySelectorAll('#sidebarNav .sidebar-link');
            const contentSections = document.querySelectorAll('.content-section');
            const mainContentArea = document.querySelector('main');

            function setActiveSection(targetId) {
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.dataset.target === targetId) {
                        link.classList.add('active');
                    }
                });
                contentSections.forEach(section => {
                    section.classList.remove('active');
                    if (section.id === targetId) {
                        section.classList.add('active');
                    }
                });
                mainContentArea.scrollTop = 0; // Scroll to top of content area
            }

            navLinks.forEach(link => {
                link.addEventListener('click', function (event) {
                    event.preventDefault();
                    const targetId = this.dataset.target;
                    setActiveSection(targetId);
                    // Update URL hash for better navigation/bookmarking
                    window.location.hash = targetId;
                });
            });

            // Check for hash in URL on page load
            const currentHash = window.location.hash.substring(1);
            if (currentHash) {
                setActiveSection(currentHash);
            } else {
                // Set default active section (e.g., intro)
                setActiveSection('intro');
            }
        });
    </script>



</body></html>